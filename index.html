<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è¡Œç¨‹è®¡åˆ’</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="main-container">
        <!-- ç”¨æˆ·é€‰æ‹©å™¨ -->
        <div class="user-selector">
            <div class="user-selector-label">å½“å‰ç”¨æˆ·ï¼š</div>
            <div class="user-buttons">
                <button class="user-btn" data-user="userA">ğŸ‘¤ ç”¨æˆ·A</button>
                <button class="user-btn" data-user="userB">ğŸ‘¤ ç”¨æˆ·B</button>
            </div>
        </div>

        <!-- åŒæ­¥æ§åˆ¶æ ï¼ˆå¯å±•å¼€ï¼‰ -->
        <div class="sync-controls">
            <button class="sync-toggle-btn" onclick="toggleSyncPanel()">
                <span>â˜ï¸ åŒæ­¥ä¸æ•°æ®</span>
                <span class="sync-toggle-icon">â–¼</span>
            </button>
            <div class="sync-panel" id="sync-panel">
                <div class="sync-buttons">
                    <button class="sync-btn" onclick="syncUpload()" title="æ‰‹åŠ¨ä¸Šä¼ åˆ°äº‘ç«¯">â˜ï¸ ä¸Šä¼ </button>
                    <button class="sync-btn" onclick="syncDownload()" title="ä»äº‘ç«¯ä¸‹è½½">â¬‡ï¸ ä¸‹è½½</button>
                    <button class="sync-btn" onclick="showSyncConfig()" title="é…ç½®åŒæ­¥">âš™ï¸ é…ç½®</button>
                    <button class="sync-btn" onclick="showConfigInfo()" title="æŸ¥çœ‹é…ç½®ä¿¡æ¯ï¼ˆç”¨äºå¤‡ä»½ï¼‰">â„¹ï¸ é…ç½®ä¿¡æ¯</button>
                    <button class="sync-btn" onclick="exportData()" title="å¯¼å‡ºæ•°æ®ï¼ˆå¤‡ä»½ï¼‰">ğŸ’¾ å¯¼å‡º</button>
                    <button class="sync-btn" onclick="importData()" title="å¯¼å…¥æ•°æ®">ğŸ“¥ å¯¼å…¥</button>
                </div>
                <div id="sync-status" class="sync-status"></div>
            </div>
        </div>

        <!-- æ–°å¢è¡Œç¨‹é¡¹æ¨¡æ€æ¡† -->
        <div id="add-item-modal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>æ–°å¢è¡Œç¨‹é¡¹</h3>
                    <button class="modal-close" onclick="closeAddItemModal()">Ã—</button>
                </div>
                <div class="modal-body">
                    <div class="config-section">
                        <label for="new-item-category">äº‹é¡¹åç§° *</label>
                        <input type="text" id="new-item-category" placeholder="ä¾‹å¦‚ï¼šæ—©é¤ã€æ™¯ç‚¹æ¸¸è§ˆç­‰" required>
                    </div>
                    <div class="config-section">
                        <label for="new-item-time">æ—¶é—´</label>
                        <input type="text" id="new-item-time" placeholder="ä¾‹å¦‚ï¼š08:00-10:00">
                    </div>
                    <div class="config-section">
                        <label for="new-item-plan">è®¡åˆ’</label>
                        <textarea id="new-item-plan" rows="3" placeholder="è¾“å…¥è®¡åˆ’å†…å®¹..."></textarea>
                    </div>
                    <div class="config-section">
                        <label for="new-item-note">å¤‡æ³¨</label>
                        <textarea id="new-item-note" rows="3" placeholder="è¾“å…¥å¤‡æ³¨ä¿¡æ¯..."></textarea>
                    </div>
                    <div class="config-section">
                        <label for="new-item-tag">åˆ†ç±»æ ‡ç­¾</label>
                        <select id="new-item-tag">
                            <option value="å…¶ä»–">ğŸ“‹ å…¶ä»–</option>
                            <option value="æ™¯ç‚¹">ğŸ›ï¸ æ™¯ç‚¹</option>
                            <option value="ç¾é£Ÿ">ğŸœ ç¾é£Ÿ</option>
                            <option value="ä½å®¿">ğŸ¨ ä½å®¿</option>
                            <option value="èµ¶è·¯">ğŸš— èµ¶è·¯</option>
                        </select>
                    </div>
                    <div class="config-actions">
                        <button class="btn-primary" onclick="saveNewItem()">ä¿å­˜</button>
                        <button class="btn-secondary" onclick="closeAddItemModal()">å–æ¶ˆ</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- åŒæ­¥é…ç½®æ¨¡æ€æ¡† -->
        <div id="sync-config-modal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>åŒæ­¥é…ç½®</h3>
                    <button class="modal-close" onclick="closeSyncConfig()">Ã—</button>
                </div>
                <div class="modal-body">
                    <div class="config-section">
                        <label>åŒæ­¥æ–¹å¼ï¼š</label>
                        <select id="sync-type-select" onchange="toggleSyncType()">
                            <option value="gist">GitHub Gistï¼ˆæ¨èï¼Œå…è´¹ï¼‰</option>
                            <option value="firebase">Firebase Realtime Databaseï¼ˆå®æ—¶åŒæ­¥ï¼‰</option>
                        </select>
                    </div>
                    
                    <!-- GitHub Gist é…ç½® -->
                    <div id="gist-config" class="sync-config-panel">
                        <div class="config-section">
                            <label for="github-token-input">GitHub Personal Access Tokenï¼š</label>
                            <input type="password" id="github-token-input" placeholder="ghp_xxxxxxxxxxxx">
                            <small>éœ€è¦åˆ›å»ºGitHub Tokenï¼Œå‹¾é€‰gistæƒé™ã€‚ç‚¹å‡»ä¸‹æ–¹é“¾æ¥æŸ¥çœ‹æ•™ç¨‹</small>
                            <a href="https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/creating-a-personal-access-token" target="_blank" class="help-link">å¦‚ä½•åˆ›å»ºTokenï¼Ÿ</a>
                        </div>
                        <div class="config-section">
                            <label for="gist-id-input">Gist IDï¼ˆé¦–æ¬¡ä½¿ç”¨ç•™ç©ºï¼Œä¼šè‡ªåŠ¨åˆ›å»ºï¼‰ï¼š</label>
                            <input type="text" id="gist-id-input" placeholder="ç•™ç©ºåˆ™è‡ªåŠ¨åˆ›å»ºæ–°çš„Gist">
                            <small>å¦‚æœå·²ç»åˆ›å»ºè¿‡Gistï¼Œå¯ä»¥è¾“å…¥Gist IDç›´æ¥ä½¿ç”¨</small>
                        </div>
                    </div>
                    
                    <!-- Firebase é…ç½® -->
                    <div id="firebase-config" class="sync-config-panel" style="display: none;">
                        <div class="config-section">
                            <label for="firebase-api-key">API Keyï¼š</label>
                            <input type="text" id="firebase-api-key" placeholder="AIza...">
                        </div>
                        <div class="config-section">
                            <label for="firebase-auth-domain">Auth Domainï¼š</label>
                            <input type="text" id="firebase-auth-domain" placeholder="your-project.firebaseapp.com">
                        </div>
                        <div class="config-section">
                            <label for="firebase-database-url">Database URLï¼š</label>
                            <input type="text" id="firebase-database-url" placeholder="https://your-project.firebaseio.com">
                        </div>
                        <div class="config-section">
                            <label for="firebase-project-id">Project IDï¼š</label>
                            <input type="text" id="firebase-project-id" placeholder="your-project-id">
                        </div>
                        <div class="config-section">
                            <label for="firebase-database-path">Database Pathï¼ˆå¯é€‰ï¼‰ï¼š</label>
                            <input type="text" id="firebase-database-path" placeholder="trip_plan_data" value="trip_plan_data">
                            <small>æ•°æ®å­˜å‚¨è·¯å¾„ï¼Œé»˜è®¤ï¼štrip_plan_data</small>
                        </div>
                        <div class="config-section">
                            <small>âš ï¸ æ³¨æ„ï¼šä½¿ç”¨Firebaseéœ€è¦å…ˆå¼•å…¥Firebase SDKã€‚åœ¨index.htmlä¸­æ·»åŠ ï¼š<br>
                            &lt;script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js"&gt;&lt;/script&gt;<br>
                            &lt;script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js"&gt;&lt;/script&gt;</small>
                        </div>
                    </div>
                    
                    <div class="config-section">
                        <label>
                            <input type="checkbox" id="auto-sync-checkbox">
                            å¯ç”¨è‡ªåŠ¨åŒæ­¥
                            <span id="auto-sync-desc">ï¼ˆæ¯30ç§’è‡ªåŠ¨ä¸Šä¼ ï¼‰</span>
                        </label>
                    </div>
                    <div class="config-actions">
                        <button class="btn-primary" onclick="saveSyncConfig()">ä¿å­˜é…ç½®</button>
                        <button class="btn-secondary" onclick="closeSyncConfig()">å–æ¶ˆ</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- æ ‡é¢˜åŒºåŸŸ -->
        <div class="header">
            <h1>æµ™ä¸œè¡Œç¨‹è®¡åˆ’ï¼ˆä¸Šæµ·â†’ç»å…´â†’è¡¢å·â†’ä¹‰ä¹Œâ†’ä¸Šæµ·ï¼‰</h1>
        </div>

        <!-- ç›®å½•å¯¼èˆª -->
        <div class="nav-container">
            <h2>è¡Œç¨‹æ€»è§ˆ</h2>
            <ul class="nav-list">
                <!-- å¯¼èˆªé¡¹å°†ç”± JavaScript åŠ¨æ€ç”Ÿæˆ -->
            </ul>
        </div>

        <!-- ç­›é€‰é¢æ¿ -->
        <div id="filter-panel" class="filter-panel" style="display: none;">
            <div class="filter-buttons">
                <button class="filter-tag-btn" onclick="setFilter('all')">å…¨éƒ¨</button>
                <button class="filter-tag-btn" onclick="setFilter('æ™¯ç‚¹')">ğŸ›ï¸ æ™¯ç‚¹</button>
                <button class="filter-tag-btn" onclick="setFilter('ç¾é£Ÿ')">ğŸœ ç¾é£Ÿ</button>
                <button class="filter-tag-btn" onclick="setFilter('ä½å®¿')">ğŸ¨ ä½å®¿</button>
                <button class="filter-tag-btn" onclick="setFilter('èµ¶è·¯')">ğŸš— èµ¶è·¯</button>
                <button class="filter-tag-btn" onclick="setFilter('å…¶ä»–')">ğŸ“‹ å…¶ä»–</button>
            </div>
        </div>

        <!-- æ—¥æœŸæ ‡é¢˜ -->
        <div class="day-header">
            <h2>Day 1: ä¸Šæµ· â†’ ç»å…´ï¼ˆä¸å˜ï¼‰</h2>
        </div>

        <!-- å¡ç‰‡å®¹å™¨ -->
        <div id="cards-container" class="cards-container">
            <div class="card-indicator"></div>
        </div>
    </div>

    <!-- å¼•å…¥æ•°æ®æ–‡ä»¶ -->
    <script src="data.js"></script>
    <!-- ä¸å†ä»config.jså¯¼å…¥tokenï¼Œtokenç¼“å­˜åœ¨localStorageä¸­ -->
    <!-- Firebase SDK (å¦‚æœä½¿ç”¨FirebaseåŒæ­¥) -->
    <script type="module">
        // å¯¼å…¥ Firebase SDK
        import { initializeApp } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-app.js";
        import { getDatabase } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-database.js";
        
        // Firebase é…ç½®
        const firebaseConfig = {
            apiKey: "AIzaSyD1ibXnpROs_28gzzfBIPzvwvNYj13gSOM",
            authDomain: "trip-plan-cetus.firebaseapp.com",
            databaseURL: "https://trip-plan-cetus-default-rtdb.asia-southeast1.firebasedatabase.app",
            projectId: "trip-plan-cetus",
            storageBucket: "trip-plan-cetus.firebasestorage.app",
            messagingSenderId: "593052021342",
            appId: "1:593052021342:web:951da391daaed3a0f67acf",
            measurementId: "G-WVNF8DL6QD"
        };
        
        // åˆå§‹åŒ– Firebase
        const app = initializeApp(firebaseConfig);
        const database = getDatabase(app);
        
        // å°† Firebase å®ä¾‹æš´éœ²åˆ°å…¨å±€ï¼Œä¾› sync-firebase.js ä½¿ç”¨
        window.firebaseApp = app;
        window.firebaseDatabase = database;
        window.firebaseConfig = firebaseConfig;
        
        // æ ‡è®° Firebase å·²åŠ è½½
        window.firebaseLoaded = true;
        
        // è§¦å‘è‡ªå®šä¹‰äº‹ä»¶ï¼Œé€šçŸ¥ Firebase å·²åŠ è½½
        window.dispatchEvent(new CustomEvent('firebaseReady'));
    </script>
    <!-- å¼•å…¥åŒæ­¥åŠŸèƒ½ -->
    <script src="sync.js"></script>
    <script src="sync-firebase.js"></script>
    <!-- å¼•å…¥é€»è¾‘æ–‡ä»¶ -->
    <script src="script.js"></script>
</body>
</html>

